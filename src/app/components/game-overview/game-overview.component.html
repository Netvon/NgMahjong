<ng-template #loading>
	<div class="level">
		<div class="level-item">
			<i class="fa fa-circle-o-notch fa-spin fa-3x fa-fw"></i>
			<span class="sr-only">Loading...</span>
		</div>
	</div>
</ng-template>

<div *ngIf="!isLoading; else loading"></div>

<div *ngIf="games | async; else loading; let lGames">

	<app-pagination [list]="lGames" [url]="getPaginationUrl()" [pagination]="pagination"></app-pagination>

	<div *ngFor="let game of lGames.items" class="box">
		<div class="level">
			<div class="level-left">
				<h4 class="title is-4">
					<span [title]="game.createdBy._id">{{ game.createdBy.name }}</span>
					<span class="tag">{{ game.state | titlecase }}</span>
				</h4>
			</div>
			<div class="level-right">
				<p class="title is-6 level-item">
					<time title="{{game.createdOn | amCalendar}}">{{ game.createdOn | amTimeAgo }}</time>
				</p>
			</div>
		</div>

		<!--<details>
			<div class="content">
				<pre>{{ game | json }}</pre>
			</div>
		</details>-->

		<!--<p>{{ game.createdOn | date }} {{ game.createdOn | date:'jm' }}</p>-->

		<div class="columns">
			<div class="column has-text-centered">
				<div>
					<p class="heading">Type</p>
					<p class="title">{{ game.gameTemplate.id }}</p>
				</div>
			</div>
			<div class="column has-text-centered">
				<div>
					<p class="heading">Current Players</p>
					<p class="title">{{ game.players.length }} / {{ game.maxPlayers }}</p>
				</div>
			</div>
			<div class="column has-text-centered">
				<div>
					<p class="heading">Min Players</p>
					<p class="title">{{ game.minPlayers }}</p>
				</div>
			</div>
			<div class="column" >
				<div class="block">
					<a class="button is-large" *ngIf="game.canJoin" (click)="joinClicked($event, game)">Join</a>
					<a class="button is-large" [routerLink]="['/game', game.id]">View</a>
				</div>
			</div>
		</div>

		<!--<div class="level game-section detail">
			<div class="level-left">
				<div class="level-item">
					<div>
						<p class="heading">Created On</p>
						<p class="title is-6"><time title="{{game.createdOn | amCalendar}}">{{ game.createdOn | amTimeAgo }}</time></p>
					</div>
				</div>
				<div class="level-item" *ngIf="game.startedOn">
					<div>
						<p class="heading">Started On</p>
						<p class="title is-6">{{ game.startedOn | amTimeAgo }}</p>
					</div>
				</div>
				<div class="level-item" *ngIf="game.endedOn">
					<div>
						<p class="heading">Ended On</p>
						<p class="title is-6">{{ game.startedOn | amTimeAgo }}</p>
					</div>
				</div>
			</div>
		</div>-->
	</div>

	<app-pagination [list]="lGames" [url]="'/opengames'" [pagination]="pagination"></app-pagination>

</div>
